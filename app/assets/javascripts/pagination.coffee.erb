jQuery ->
  if $('#infinite-scrolling').exists()
    $(window).scroll (e) ->
      tolerance = 300
      more_records_url = $('.pagination .next_page a').attr 'href'
      console.log more_records_url
      if more_records_url &&
          $(window).scrollTop() > $(document).height() - $(window).height() - tolerance
        # display a loading gif
        $('.pagination').html(
          '<%= image_tag asset_path('ajax-loader.gif'), alt: 'Loading...', title: 'Loading...' %>'
        )
        $.getScript more_records_url
      return
    return

